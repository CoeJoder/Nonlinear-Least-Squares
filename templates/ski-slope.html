<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Ski Slope Least Squares</title>
    <link rel="stylesheet" href="https://code.jquery.com/ui/1.12.0/themes/smoothness/jquery-ui.css">
    <link rel="stylesheet" href="{{ url_for('static', filename='ski-slope.css') }}">
    <link rel="stylesheet"
            href="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.css"
            integrity="sha384-xNwWFq3SIvM4dq/1RUyWumk8nj/0KFg4TOnNcfzUU4X2gNn3WoRML69gO7waf3xh"
            crossorigin="anonymous">
    <link rel="shortcut icon" href="{{ url_for('static', filename='favicon.ico') }}">
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon-32x32.png') }}" sizes="32x32" />
    <link rel="icon" type="image/png" href="{{ url_for('static', filename='favicon-16x16.png') }}" sizes="16x16" />
    <script
            src="https://code.jquery.com/jquery-3.3.1.min.js"
            integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8="
            crossorigin="anonymous"></script>
    <script
            src="https://code.jquery.com/ui/1.12.0/jquery-ui.min.js"
            integrity="sha256-eGE6blurk5sHj+rmkfsGYeKyZx3M4bG+ZlFyA7Kns7E="
            crossorigin="anonymous"></script>
    <!-- uncomment to render curve equation dynamically -->
    <!--script defer
            src="https://cdn.jsdelivr.net/npm/katex@0.10.0/dist/katex.js"
            integrity="sha384-UP7zD+aGyuDvxWQEDSRYcvoTxJSD82C6VvuEBktJZGo25CVhDstY9sCDHvyceo9L"
            crossorigin="anonymous"></script-->
    <script src="{{ url_for('static', filename='ski-slope.js') }}"></script>
</head>
<body>
    <div class="ui-widget" id="main">
        <h1>Ski Slope Least Squares</h1>
        <form id="spreadsheet_upload" action="{{ url_for('ski_slope') }}" method="post" enctype="multipart/form-data">
            <div>
                <div>Select measurement data</div>
                <div><input class="ui-button ui-widget ui-corner-all" type="file" name="spreadsheet"/></div>
            </div>
            <div>
                <div id="curve_equation">
                    {% raw %}
                    <!-- generated from kratex.js -->
                    <span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>y</mi><mo>=</mo><mi>h</mi><mo>⋅</mo><mi>cos</mi><mo>⁡</mo><mrow><mo fence="true">(</mo><mfrac><mrow><mn>2</mn><mi>π</mi><mo>(</mo><mi>x</mi><mo>+</mo><mi>v</mi><mo>)</mo></mrow><mi>p</mi></mfrac><mo fence="true">)</mo></mrow><mo>+</mo><mi>b</mi></mrow><annotation encoding="application/x-tex">y = h \cdot \cos \left({{2\pi(x + v) \over p }}\right) + b</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height: 0.625em; vertical-align: -0.19444em;"></span><span style="margin-right: 0.03588em;" class="mord mathdefault">y</span><span class="mspace" style="margin-right: 0.277778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right: 0.277778em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">h</span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">⋅</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 1.80002em; vertical-align: -0.65002em;"></span><span class="mop">cos</span><span class="mspace" style="margin-right: 0.166667em;"></span><span class="minner"><span class="mopen delimcenter" style="top: 0em;"><span class="delimsizing size2">(</span></span><span class="mord"><span class="mord"><span class="mord"><span class="mopen nulldelimiter"></span><span class="mfrac"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height: 1.01em;"><span class="" style="top: -2.655em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span><span class="" style="top: -3.23em;"><span class="pstrut" style="height: 3em;"></span><span class="frac-line" style="border-bottom-width: 0.04em;"></span></span><span class="" style="top: -3.485em;"><span class="pstrut" style="height: 3em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mtight">2</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">π</span><span class="mopen mtight">(</span><span class="mord mathdefault mtight">x</span><span class="mbin mtight">+</span><span style="margin-right: 0.03588em;" class="mord mathdefault mtight">v</span><span class="mclose mtight">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height: 0.481108em;"><span class=""></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span><span class="mclose delimcenter" style="top: 0em;"><span class="delimsizing size2">)</span></span></span><span class="mspace" style="margin-right: 0.222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right: 0.222222em;"></span></span><span class="base"><span class="strut" style="height: 0.69444em; vertical-align: 0em;"></span><span class="mord mathdefault">b</span></span></span></span>
                    {% endraw %}
                </div>
            </div>
            <div>
                <div>Initial guess for independent variables</div>
                <div>
                    <label>h: <input type="text" size="5" name="h" value="700"/></label>
                    <label>b: <input type="text" size="5" name="b" value="200"/></label>
                    <label>v: <input type="text" size="5" name="v" value="0"/></label>
                    <label>p: <input type="text" size="5" name="p" value="24"/></label>
                </div>
            </div>
            <div>
                <div>
                    <input class="ui-checkbox ui-widget ui-corner-all" id="specify_bounds" name="specify_bounds" type="checkbox" value="specify_bounds" />
                    <label for="specify_bounds">Specify upper and lower bounds</label>
                </div>
                <div id="bounds">
                    <div id="bounds_overlay"></div>
                    <div>
                        <label>h: <input type="text" size="5" name="h_upper" value="inf"/></label>
                        <label>b: <input type="text" size="5" name="b_upper" value="inf"/></label>
                        <label>v: <input type="text" size="5" name="v_upper" value="inf"/></label>
                        <label>p: <input type="text" size="5" name="p_upper" value="inf"/></label>
                        <span>(upper, inclusive)</span>
                    </div>
                    <div>
                        <label>h: <input type="text" size="5" name="h_lower" value="-inf"/></label>
                        <label>b: <input type="text" size="5" name="b_lower" value="-inf"/></label>
                        <label>v: <input type="text" size="5" name="v_lower" value="-inf"/></label>
                        <label>p: <input type="text" size="5" name="p_lower" value="-inf"/></label>
                        <span>(lower, inclusive)</span>
                    </div>
                </div>
            </div>
            <div>
                <div>Maximum number of function evaluations</div>
                <div><input type="text" size="20" name="max_nfev" value="1000000000"/></div>
            </div>
            <div>
                <input class="ui-checkbox ui-widget ui-corner-all" id="include_text" name="include_text" type="checkbox" value="include_text" checked="true"/>
                <label for="include_text">Include all calculated values in the output image</label>
            </div>
            <div>
                <button class="ui-button ui-widget ui-corner-all" type="submit" value="Upload">
                    <span class="ui-icon ui-icon-gear"></span> Do Curve Fit
                </button>
                <img id="spinner" src="{{ url_for('static', filename='spinner.gif') }}" />
            </div>
        </form>
        <p id="error_log"></p>
        <div id="image_container"></div>
        <div id="calc_results_container"></div>
    </div>
</body>
</html>
